# Profile Completion Warning on Home Page - Technical Plan

## Feature Description

Display a warning message on the home page for players who have not yet populated their phone number, DNI, or t-shirt size. This warning should only appear for players (not administrators) and should prompt them to complete their profile information.

## Database Schema Changes

No database changes required - the fields (`phone_number`, `dni`, `tshirt_size`) already exist in the users table from previous features.

## Backend API Changes

No backend API changes required - the `/protected/me` endpoint already returns all user fields including `phone_number`, `dni`, and `tshirt_size`.

## Frontend Changes

### Phase 1: Update Auth Context Types

**File: `ui/src/lib/auth-context.tsx`**

- Update `ServerUser` type to include the missing profile fields:
  - Add `dni?: string` field
  - Add `tshirt_size?: string` field
- The type should match what the API returns from `/protected/me` endpoint

**Current type** (around lines 8-18):
```typescript
type ServerUser = {
  id: string;
  email: string;
  first_name?: string;
  last_name?: string;
  phone_number?: string;
  role: string;
  profile_picture_url?: string;
  created_at: string;
  updated_at: string;
};
```

**Updated type should include**:
- `dni?: string`
- `tshirt_size?: string`

### Phase 2: Create Profile Warning Component

**File: `ui/src/components/ProfileWarning.tsx` (new file)**

- Create a new component that:
  - Accepts `serverUser` and `isAdmin` as props
  - Checks if any of the following fields are missing/null/empty: `phone_number`, `dni`, `tshirt_size`
  - Only shows warning if user is NOT an admin (`!isAdmin`)
  - Displays an Alert component with warning styling
  - Lists which fields are missing
  - Includes a button/link to navigate to the profile page
  - Uses translation keys for text

**Component logic**:
1. If `isAdmin` is true, return `null` (don't show warning)
2. If `serverUser` is null, return `null` (user data not loaded)
3. Check if `phone_number`, `dni`, or `tshirt_size` are missing/empty
4. If all fields are present, return `null`
5. If any fields are missing, render Alert component

**Field validation logic**:
- A field is considered "missing" if it's:
  - `undefined`
  - `null`
  - Empty string (`""`)
  - Whitespace-only string (trimmed length === 0)

### Phase 3: Update Home Page

**File: `ui/src/pages/Home.tsx`**

- Import necessary dependencies:
  - `useAuth` from `@/lib/auth-context`
  - `ProfileWarning` component
  - `useNavigate` from `react-router-dom` (if needed for link)
- Add the `ProfileWarning` component to the Home page JSX
- Position the warning banner prominently (likely at the top, before or above the background image)
- Ensure the warning is visible but doesn't completely block the home page content

**Layout considerations**:
- The current Home page displays a full-screen background image
- The warning should be positioned in a way that's visible (perhaps as an overlay at the top or as a banner above the image)
- Consider using absolute/fixed positioning or a separate container that overlays the image

### Phase 4: Add Translation Keys

**Files:**
- `ui/src/locales/en/common.json` (or create `ui/src/locales/en/home.json` if preferred)
- `ui/src/locales/es/common.json` (or create `ui/src/locales/es/home.json` if preferred)

**Translation keys to add:**
- `profileIncompleteWarning`: Title/heading for the warning (e.g., "Complete Your Profile")
- `profileIncompleteMessage`: Main message explaining what's missing (e.g., "Please complete your profile information to continue")
- `profileIncompleteFields`: Description of missing fields (e.g., "Missing: Phone Number, DNI, T-shirt Size")
- `updateProfile`: Button text to go to profile page (e.g., "Update Profile" or "Complete Profile")
- Or a more dynamic approach: keys for individual field names and a template message

**Translation approach options:**
1. **Static message**: Simple keys like "Your profile is missing phone number, DNI, or t-shirt size"
2. **Dynamic message**: Keys for each field type plus a template that lists missing fields dynamically

**Recommendation**: Use dynamic approach with keys like:
- `profileMissingPhoneNumber`: "Phone Number"
- `profileMissingDNI`: "DNI"  
- `profileMissingTshirtSize`: "T-shirt Size"
- `profileIncompleteWarningTitle`: "Complete Your Profile"
- `profileIncompleteWarningDescription`: "The following information is missing from your profile:"
- `profileIncompleteUpdateButton`: "Update Profile"

## Implementation Algorithm

1. **Update Auth Context**: Add `dni` and `tshirt_size` to `ServerUser` type
2. **Create Warning Component**: Build `ProfileWarning` component that checks for missing fields
3. **Update Home Page**: Integrate warning component into Home page
4. **Add Translations**: Create translation keys in both English and Spanish
5. **Styling**: Ensure warning is visible and properly styled with appropriate alert variant

## Files to Create/Modify

### New Files
- `ui/src/components/ProfileWarning.tsx` - Warning banner component

### Modified Files
- `ui/src/lib/auth-context.tsx` - Add `dni` and `tshirt_size` to `ServerUser` type
- `ui/src/pages/Home.tsx` - Add `ProfileWarning` component
- `ui/src/locales/en/common.json` - Add translation keys (or create `ui/src/locales/en/home.json`)
- `ui/src/locales/es/common.json` - Add translation keys (or create `ui/src/locales/es/home.json`)

## UI/UX Considerations

- The warning should be prominent but not intrusive
- Consider using Alert component with a warning variant (if available) or default variant with appropriate styling
- The warning should include a clear call-to-action button to navigate to profile page
- The warning should disappear once all required fields are filled
- Mobile responsiveness should be considered for the warning banner

## Important Notes

- The warning should only appear for players (role !== "admin")
- The warning should gracefully handle loading states (when `serverUser` is null)
- Field validation should treat empty strings and whitespace as "missing"
- The warning should automatically update when the user completes their profile (if they navigate back to home)

