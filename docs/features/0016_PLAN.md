# Admin Edit Teams from Team Management Page (Modal-embedded TeamDetail)

## Context
Admins must be able to edit teams directly from the Team Management page (`AdminAllTeams.tsx`). Required actions include: adding players via the existing player search modal, removing players, and editing team availability. To avoid duplicating UI/logic, we will reuse the existing Team Detail page UI, but render it inside a modal triggered from each team card. The modal must provide a clear path to close and return to the Team Management page.

## Files/Modules to Update
- `ui/src/pages/AdminAllTeams.tsx`
  - Add an “Edit” button in the top-right of each team card (beside badges/triangle).
  - Add modal state (selected team ID) and a dialog/sheet to render the embedded team detail.
  - On modal close, refresh the team list (in case changes were made).

- `ui/src/pages/TeamDetail.tsx`
  - Add optional props to support embedded usage in a modal (admin context):
    - `embedded?: boolean` (hides page-level chrome and back nav when `true`).
    - `onClose?: () => void` (used to close the parent modal when embedded).
    - `forceAdmin?: boolean` (ensures admin capabilities regardless of the viewer’s role).
  - When `embedded` is true:
    - Hide the outer page header/back button.
    - Reduce paddings/margins to fit modal.
    - Do not attempt to navigate via router on success actions; use callbacks instead where appropriate.

- `ui/src/components/PlayerSearchModal.tsx`
  - No functional changes expected; verify it works when launched within an embedded TeamDetail (modal-in-modal). If nested modals conflict, optionally switch to a sheet or ensure proper z-index and focus management.

- `ui/src/components/TeamAvailabilityModal.tsx`
  - No functional changes expected; verify it works in embedded mode.

- `ui/src/lib/serverComm.ts`
  - No new endpoints required; ensure existing team/member update endpoints are used by embedded detail.

## UI/UX Details
- In each team card (`AdminAllTeams.tsx`) header, add an Edit icon button (e.g., Pencil/Edit icon) aligned with the badges/warning triangle.
- Clicking Edit opens a dialog with:
  - Title: Team name.
  - Body: Embedded TeamDetail (for the selected team ID) with `embedded` and `forceAdmin` flags.
  - Footer: Close button (X) in the top-right of the dialog content; no back navigation within the embedded content.
- On save/remove actions performed within embedded TeamDetail, the TeamDetail already calls required APIs; no extra changes needed. After closing the dialog, call `loadTeams()` to refresh the admin view.

## Data Flow
1. Admin clicks Edit on a team card.
2. `AdminAllTeams.tsx` sets `selectedTeamId`, opens Dialog.
3. Dialog renders `<TeamDetail embedded forceAdmin teamId={selectedTeamId} onClose={closeDialog}/>`.
4. Admin performs actions in embedded TeamDetail:
   - Add/remove members via existing modals and APIs.
   - Edit availability via existing modal and APIs.
5. Admin closes dialog → `onClose` fires → `AdminAllTeams` reloads teams via `loadTeams()`.

## Algorithmic/Logical Notes
- Embedded TeamDetail should:
  - Suppress page-level layout elements (no external navbar/back).
  - Avoid router redirects. Replace with `onClose` or local success feedback.
  - Rely on already implemented server calls in `serverComm.ts`.
- Handle loading/error states locally within embedded component as today.

## Accessibility/Responsiveness
- Dialog must be keyboard accessible and focus-trapped.
- Ensure modals within the embedded TeamDetail are layered correctly (z-index) and remain accessible.
- On mobile, dialog should be full-screen or use a sheet for better UX.

## Translations
- Add translation keys for the Edit button tooltip/label if needed (e.g., `common.edit`).

## Testing
- Open/close edit modal for multiple teams.
- Add player, remove player, edit availability; verify team list refreshes upon close.
- Confirm admin-only capabilities are enforced when `forceAdmin` is set.
- Verify nested modals operate correctly within the dialog (no focus/z-index issues).

## Implementation Steps (Concise)
1. `AdminAllTeams.tsx`: Add Edit button per card; add dialog state; embed `TeamDetail` in dialog; reload teams on close.
2. `TeamDetail.tsx`: Add `embedded`, `onClose`, `forceAdmin` props; hide outer page chrome when embedded; convert back navigation to `onClose`.
3. Verify `PlayerSearchModal` and `TeamAvailabilityModal` within embedded scenario; adjust z-index if necessary.
4. Add i18n key usage for Edit button if not already present.
5. Test all flows and fix minor UI polish (padding in dialog, scroll behavior, mobile layout).
