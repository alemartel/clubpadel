# Admin Team Creation from Teams Management Page

## Context

Admins need the ability to create teams directly from the teams admin page (`AdminAllTeams.tsx`). When an admin creates a team, it should be created empty with no members, unlike when a player creates a team where the creator is automatically added as the first member. The team creation form should be the same as the player team creation form, but with admin-specific backend handling.

## Files/Modules to Update

### Backend API

**File**: `server/src/api.ts`

- Modify the existing `protectedRoutes.post("/teams", ...)` endpoint (lines 1014-1116):
  - Check if the creator is an admin (`user.role === "admin"`)
  - If admin:
    - Skip gender validation for the creator (lines 1045-1056) - admins can create teams of any gender regardless of their own gender
    - Skip adding the creator as a team member (lines 1087-1095) - team is created empty
    - Skip creating the "joined" notification for the creator (lines 1097-1105)
  - If not admin:
    - Keep existing behavior: validate creator's gender matches team gender, add creator as member, create notification

### Frontend - Admin Teams Page

**File**: `ui/src/pages/AdminAllTeams.tsx`

- Add state for create team modal:
  - `const [showCreateTeamModal, setShowCreateTeamModal] = useState(false)`
- Add "Create Team" button in the filters section (near line 164-210):
  - Button should be visible only to admins (check `useAuth` for `isAdmin`)
  - Place button after the filter controls, aligned with the filter row
  - Use Plus icon from lucide-react
- Add create team dialog/modal:
  - Reuse the form logic from `CreateTeam.tsx` component
  - Create a new component or inline the form in a Dialog
  - Form fields:
    - Team name (Input, required, max 100 chars)
    - Level select (1, 2, 3, 4)
    - Gender select (Masculine, Femenine, Mixed)
  - Form validation:
    - All fields required
    - No gender mismatch validation needed (admin can create any gender team)
  - On successful submission:
    - Call `api.createTeam()` with team data
    - On success: close modal, refresh teams list via `loadTeams()`
    - On error: display error message in modal
- Handle form submission:
  - Same API call as player team creation: `api.createTeam({ name, level, gender })`
  - Backend will handle admin-specific logic (empty team creation)

### Frontend - API Client

**File**: `ui/src/lib/serverComm.ts`

- No changes needed - the existing `createTeam()` function works for both admin and player team creation
- The backend will automatically detect if the requester is an admin and handle accordingly

## Algorithmic/Logical Notes

### Admin Team Creation Flow

1. Admin clicks "Create Team" button on AdminAllTeams page
2. Modal opens with team creation form (name, level, gender)
3. Admin fills form and submits
4. Frontend calls `api.createTeam()` with form data
5. Backend checks `user.role === "admin"`:
   - If admin: creates team without adding creator as member, skips gender validation
   - If not admin: creates team with creator as member, validates gender
6. Frontend receives team creation response
7. On success: modal closes, teams list refreshes to show new empty team
8. Admin can then edit the team to add members using existing edit functionality

### Differences from Player Team Creation

- **No automatic member addition**: Admin-created teams start empty
- **No gender validation**: Admins can create teams of any gender regardless of their own gender
- **No notification creation**: No "joined" notification since admin doesn't join the team
- **Same form fields**: Team name, level, and gender selection remain the same
- **Same passcode generation**: Teams still get a unique passcode for joining

## UI/UX Details

- Add "Create Team" button in the filter card header row, aligned with other filter controls
- Button uses Plus icon and "Create Team" text
- Modal/dialog should match styling of other modals in the app (use Dialog component)
- Form should be identical to the player team creation form for consistency
- After creation, show success state (modal closes, list refreshes automatically)
- Error handling: display error message within modal if creation fails

